'++LotusScript Development Environment:2:5:(Options):0:74
Option Public
Option Declare
%REM
**************************************************************************************************************************'
COPYRIGHT 2003-2006 by MAJKILDE Aps
**************************************************************************************************************************'
This library is programmed and owned by MAJKILDE Aps
Under the copyright laws, neither the documentation nor the software may be copied, photocopied, 
reproduced, translated, resold, or reduced to any electronic medium or machine-readable form, 
in whole or in part, without the prior written consent of MAJKILDE Aps, except in the manner described 
in the documentation or the applicable licensing agreement governing the use of the software.
**************************************************************************************************************************'
%ENDREM

Use "cls.system"

'++LotusScript Development Environment:2:5:(Forward):0:1
Declare Public Class Help As AbstractObject

'++LotusScript Development Environment:2:5:(Declarations):0:10

'# HELP #######################################################################################
Public Class Help As AbstractObject
'########################################################################################
	Private ws As NotesUIWorkspace
	Private db As NotesDatabase
	Private view As NotesView
	
	Sub new()
	'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
		Set ws = New NotesUIWorkspace		
		Set db = session.currentDatabase
		Set view = db.GetView( "admin.lookup" )
	End Sub
	
	
	Public Function open( id As String )
	'------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
		Dim doc As NotesDocument
		
		Set doc = view.GetDocumentByKey( "HELP." & id, True )
		If doc Is Nothing Then Set doc = view.GetDocumentByKey( "HELP.*", True ) 
		
		If doc Is Nothing Then
			Msgbox "No help found for " & id, "64", "No help"	
		Else
			Call ws.DialogBox( "showHelp", False, False, False, True, True, True, doc.subject( 0 ) & "(" & id & ")", doc, False, False, True )
		End If
		
	End Function
	
End Class