'++LotusScript Development Environment:2:5:(Options):0:74
Option Public
Option Declare

Use "cls.system"
Use "attachmate6"


'++LotusScript Development Environment:2:5:(Forward):0:1
Declare Class ExcelData

'++LotusScript Development Environment:2:5:(Declarations):0:10
%REM
	Class ExcelHandle
	Description: Comments for Class
%END REM
Class ExcelData
	Private excel As Variant
	Private sheet As Variant
	Private isCreated As Boolean
	private doc As NotesDocument
	
	%REM
		Sub New
		Description: Comments for Sub
	%END REM
	Sub New(sourceDoc As NotesDocument, sourceHandle As AbstractHandle )
		On Error GoTo eh
		If sourceHandle.hasObject() Then
			isCreated = false
		else
			Call sourceHandle.createFromFile( sourceHandle.getFilename())
			isCreated = true
		End If

		Set excel = sourceHandle.getObjectRef()
		Set sheet = sourceObject.Worksheets( 1 )
		
		Set doc = sourceDoc
	
done:
	Exit sub	
eh:
	Error Err, getErrorInfo( Me )
	End Sub
	
	%REM
		Function copyCell
		Description: Comments for Function
	%END REM
	Function copyCell( rangename As String, itemname As String )
		On Error GoTo eh
		Dim value As Variant
		Dim sheetname As String
		Dim range As String
		
		If InStr( rangename, "!" ) > 0 Then
			sheetname = StrLeft( rangename, "!" )
			range = StrRight( rangename, "!" )
			value = sourceObject.Worksheets( sheetname ).range( rangename ).value
		else
			value = sheet.range( rangename ).value
		End If

		Call doc.replaceItemvalue( itemname, value )
		
done:
		Exit function	
eh:
		Print "Failed: " & itemname & ":=" & cString( value ) & " (" & rangename & ")"
		Print getErrorInfo( Me )
		Error Err, getErrorInfo( Me )
	End Function
	
	Sub Delete
		If isCreated then
			Call sourceHandle.closefile()
		End if
	End sub
End Class

